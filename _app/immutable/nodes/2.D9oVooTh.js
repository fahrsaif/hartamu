import{f as Q,a as X}from"../chunks/B6wb_zx6.js";import{o as te}from"../chunks/BtNqDwAP.js";import{a as W,n as re,o as O,h as M,t as le,v as ne,w as h,x as se,y as fe,H as ie,z,A as V,e as N,C as ue,B as ve,D as oe,c as C,b as Y,s as de,E as ce,F as G,G as Z,I as _e,J as he,r as j,p as me,K as Ee,M as be,O as q,P as pe,Q as xe,R as ge,S as Te,d as ye,T as ke,U as Ae,k as we,V as Ie,W as Se,X as Me,Y as J,Z as Re,_ as De,$ as Ce,a0 as S,a1 as K,a2 as Ne,a3 as I,a4 as D,a5 as He}from"../chunks/BvCHM7d6.js";import{d as Oe,e as Ve,s as F}from"../chunks/AqWZ0_0e.js";import{r as qe}from"../chunks/Bsp4O6-U.js";import{d as H}from"../chunks/DxVxc45h.js";function Fe(e,a){return a}function Le(e,a,t){for(var f=[],o=a.length,i=0;i<o;i++)xe(a[i].e,f,!0);ge(f,()=>{var u=f.length===0&&t!==null;if(u){var c=t,n=c.parentNode;Te(n),n.append(c),e.items.clear(),y(e,a[0].prev,a[o-1].next)}for(var l=0;l<o;l++){var s=a[l];u||(e.items.delete(s.k),y(e,s.prev,s.next)),ye(s.e,!u)}e.first===a[0]&&(e.first=a[0].prev)})}function $e(e,a,t,f,o,i=null){var u=e,c={items:new Map,first:null};{var n=e;u=M?O(le(n)):n.appendChild(W())}M&&ne();var l=null,s=se(()=>{var r=t();return _e(r)?r:r==null?[]:Z(r)}),d,v=!0;function _(){Ue(p,d,c,u,a,f),l!==null&&(d.length===0?(l.fragment?(u.before(l.fragment),l.fragment=null):j(l.effect),p.first=l.effect):me(l.effect,()=>{l=null}))}var p=re(()=>{d=h(s);var r=d.length;let E=!1;if(M){var R=fe(u)===ie;R!==(r===0)&&(u=z(),O(u),V(!1),E=!0)}for(var x=new Set,m=C,g=null,k=de(),b=0;b<r;b+=1){M&&N.nodeType===ue&&N.data===ve&&(u=N,E=!0,V(!1));var A=d[b],w=f(A,b),T=v?null:c.items.get(w);T?(oe(T.v,A),T.i=b,k&&m.skipped_effects.delete(T.e)):(T=We(v?u:null,g,A,w,b,o,a,t),v&&(T.o=!0,g===null?c.first=T:g.next=T,g=T),c.items.set(w,T)),x.add(w)}if(r===0&&i&&!l)if(v)l={fragment:null,effect:Y(()=>i(u))};else{var B=document.createDocumentFragment(),P=W();B.append(P),l={fragment:B,effect:Y(()=>i(P))}}if(M&&r>0&&O(z()),!v)if(k){for(const[ee,ae]of c.items)x.has(ee)||m.skipped_effects.add(ae.e);m.oncommit(_),m.ondiscard(()=>{})}else _();E&&V(!0),h(s)});v=!1,M&&(u=N)}function Ue(e,a,t,f,o,i){var u=a.length,c=t.items,n=t.first,l,s=null,d=[],v=[],_,p,r,E;for(E=0;E<u;E+=1){if(_=a[E],p=i(_,E),r=c.get(p),t.first??=r,!r.o){r.o=!0;var R=s?s.next:n;y(t,s,r),y(t,r,R),L(r,R,f),s=r,d=[],v=[],n=s.next;continue}if((r.e.f&q)!==0&&j(r.e),r!==n){if(l!==void 0&&l.has(r)){if(d.length<v.length){var x=v[0],m;s=x.prev;var g=d[0],k=d[d.length-1];for(m=0;m<d.length;m+=1)L(d[m],x,f);for(m=0;m<v.length;m+=1)l.delete(v[m]);y(t,g.prev,k.next),y(t,s,g),y(t,k,x),n=x,s=k,E-=1,d=[],v=[]}else l.delete(r),L(r,n,f),y(t,r.prev,r.next),y(t,r,s===null?t.first:s.next),y(t,s,r),s=r;continue}for(d=[],v=[];n!==null&&n.k!==p;)(n.e.f&q)===0&&(l??=new Set).add(n),v.push(n),n=n.next;if(n===null)continue;r=n}d.push(r),s=r,n=r.next}if(n!==null||l!==void 0){for(var b=l===void 0?[]:Z(l);n!==null;)(n.e.f&q)===0&&b.push(n),n=n.next;var A=b.length;if(A>0){var w=u===0?f:null;Le(t,b,w)}}e.first=t.first&&t.first.e,e.last=s&&s.e,s&&(s.e.next=null)}function We(e,a,t,f,o,i,u,c){var n=(u&Ee)!==0,l=(u&be)===0,s=n?l?ce(t,!1,!1):G(t):t,d=(u&he)===0?o:G(o),v={i:d,v:s,k:f,a:null,e:null,o:!1,prev:a,next:null};try{if(e===null){var _=document.createDocumentFragment();_.append(e=W())}return v.e=Y(()=>i(e,s,d,c)),v.e.prev=a&&a.e,a!==null&&(a.next=v,a.e.next=v.e),v}finally{}}function L(e,a,t){for(var f=e.next?e.next.e.nodes_start:t,o=a?a.e.nodes_start:t,i=e.e.nodes_start;i!==null&&i!==f;){var u=pe(i);o.before(i),i=u}}function y(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}function Ye(e,a,t=a){var f=new WeakSet;ke(e,"input",async o=>{var i=o?e.defaultValue:e.value;if(i=$(e)?U(i):i,t(i),C!==null&&f.add(C),await Ae(),i!==(i=a())){var u=e.selectionStart,c=e.selectionEnd,n=e.value.length;if(e.value=i??"",c!==null){var l=e.value.length;u===c&&c===n&&l>n?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=u,e.selectionEnd=Math.min(c,l))}}}),(M&&e.defaultValue!==e.value||we(a)==null&&e.value)&&(t($(e)?U(e.value):e.value),C!==null&&f.add(C)),Ie(()=>{var o=a();if(e===document.activeElement){var i=Se??C;if(f.has(i))return}$(e)&&o===U(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function $(e){var a=e.type;return a==="number"||a==="range"}function U(e){return e===""?null:+e}var Be=Q("<tr><th> </th><th> </th><th> </th><th><button>edit</button> <button>delete</button></th></tr>"),Pe=Q('<form><input type="text"/> <button>submit</button></form> <table><thead><tr><th>ID</th><th>Title</th><th>Completed</th><th>Actions</th></tr></thead><tbody></tbody></table>',1);function Ze(e,a){Me(a,!0);let t=J(null),f=J(Re({id:null,title:null}));te(async()=>{await o()});async function o(){K(t,await H.sql`SELECT * FROM todos`,!0)}async function i(){h(f).id?await H.sql`
            UPDATE todos
                SET title = ${h(f).title}
                WHERE id = ${h(f).id};`:await H.sql`INSERT INTO todos (title) VALUES (${h(f).title});`,K(f,{id:null,title:null},!0),await o()}function u(_){h(f).id=_.id,h(f).title=_.title}async function c(_){await H.sql`DELETE FROM todos WHERE id = ${_.id};`,await o()}var n=Pe(),l=De(n),s=S(l);qe(s),Ne(2),I(l);var d=D(l,2),v=D(S(d));$e(v,21,()=>h(t),Fe,(_,p)=>{var r=Be(),E=S(r),R=S(E,!0);I(E);var x=D(E),m=S(x,!0);I(x);var g=D(x),k=S(g,!0);I(g);var b=D(g),A=S(b);A.__click=()=>u(h(p));var w=D(A,2);w.__click=()=>c(h(p)),I(b),I(r),He(()=>{F(R,h(p).id),F(m,h(p).title),F(k,h(p).is_completed)}),X(_,r)}),I(v),I(d),Ve("submit",l,i),Ye(s,()=>h(f).title,_=>h(f).title=_),X(e,n),Ce()}Oe(["click"]);export{Ze as component};
